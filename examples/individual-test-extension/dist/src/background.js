var c=Object.defineProperty;var d=(e,t,n)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var o=(e,t,n)=>d(e,typeof t!="symbol"?t+"":t,n);(function(){"use strict";const e="PAGE_RELOAD",t=[{missionId:1,url:"http://localhost:5137/foo.html",title:"foo 페이지 보기",point:100,missionType:"VIEW"},{missionId:2,url:"http://localhost:5137/bar.html",title:"bar 페이지 보기",point:10,missionType:"VIEW"},{missionId:3,url:"http://localhost:5137/baz.html",title:"baz 페이지 보기",point:999,missionType:"VIEW"}];class n{constructor(){o(this,"mission");o(this,"performedMission",[]);o(this,"accumulatedMission",[]);o(this,"point",0);this.mission=t}initialize(){this.performedMission=[],this.accumulatedMission=[],this.point=0}findMission(s){return this.mission.find(i=>i.missionId===s)}findUserMission(s){return this.performedMission.find(i=>i.missionId===s)}getMission(){return this.mission}getUserMission(){return this.performedMission}savePoint({missionId:s}){if(this.isEarnedMission(s).success)return{success:!1,message:"이미 적립이 완료된 미션입니다.",status:406};if(!this.isCompletedMisson(s))return{success:!1,message:"인증되지 않은 요청",status:401};const i=this.findMission(s);return this.point+=this.validateCheckPoint(i.missionId),this.accumulatedMission.push(i.missionId),{success:!0,status:201}}joinMission(s){const i=this.findMission(s);return!i||this.performedMission.find(r=>r.missionId===s)?{success:!1,message:"이미 참여중인 미션입니다.",status:404}:(this.performedMission.push(i),{success:!0,status:201})}isEarnedMission(s){return this.accumulatedMission.find(i=>i===s)?{success:!0,message:"",status:200}:{success:!1,message:"미션에 대한 적립 내역이 없습니다.",status:204}}getPoint(){return this.point}validateCheckPoint(s){return this.findMission(s).point}isCompletedMisson(s){return this.findUserMission(s)}setSavedData({performedMission:s,accumulatedMission:i,point:r}){this.performedMission=s,this.accumulatedMission=i,this.point=r}getSavedData(){return this.performedMission.length<=0&&this.accumulatedMission.length<=0?null:{performedMission:this.performedMission,accumulatedMission:this.accumulatedMission,point:this.point}}}const u=new n;chrome.runtime.onMessage.addListener(a=>{a.action===e&&chrome.tabs.query({active:!0,currentWindow:!0},s=>{s.length>0&&(u.initialize(),chrome.tabs.reload(s[0].id))})})})();
