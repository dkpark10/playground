var pt=Object.defineProperty;var ge=l=>{throw TypeError(l)};var gt=(l,h,u)=>h in l?pt(l,h,{enumerable:!0,configurable:!0,writable:!0,value:u}):l[h]=u;var g=(l,h,u)=>gt(l,typeof h!="symbol"?h+"":h,u),F=(l,h,u)=>h.has(l)||ge("Cannot "+u);var _=(l,h,u)=>(F(l,h,"read from private field"),u?u.call(l):h.get(l)),V=(l,h,u)=>h.has(l)?ge("Cannot add the same private member more than once"):h instanceof WeakSet?h.add(l):h.set(l,u),ye=(l,h,u,O)=>(F(l,h,"write to private field"),O?O.call(l,u):h.set(l,u),u),W=(l,h,u)=>(F(l,h,"access private method"),u);(function(){"use strict";var E,L,B,pe;const l=[{missionId:1,url:"http://localhost:5137/foo.html",title:"foo 페이지 보기",point:100,missionType:"VIEW"},{missionId:2,url:"http://localhost:5137/bar.html",title:"bar 페이지 보기",point:10,missionType:"VIEW"},{missionId:3,url:"http://localhost:5137/baz.html",title:"baz 페이지 보기",point:999,missionType:"VIEW"}];class h{constructor(){g(this,"mission");g(this,"performedMission",[]);g(this,"accumulatedMission",[]);g(this,"point",0);this.mission=l}initialize(){this.performedMission=[],this.accumulatedMission=[],this.point=0}findMission(t){return this.mission.find(s=>s.missionId===t)}findUserMission(t){return this.performedMission.find(s=>s.missionId===t)}getMission(){return this.mission}getUserMission(){return this.performedMission}savePoint({missionId:t}){if(this.isEarnedMission(t).success)return{success:!1,message:"이미 적립이 완료된 미션입니다.",status:406};if(!this.isCompletedMisson(t))return{success:!1,message:"인증되지 않은 요청",status:401};const s=this.findMission(t);return this.point+=this.validateCheckPoint(s.missionId),this.accumulatedMission.push(s.missionId),{success:!0,status:201}}joinMission(t){const s=this.findMission(t);return!s||this.performedMission.find(r=>r.missionId===t)?{success:!1,message:"이미 참여중인 미션입니다.",status:404}:(this.performedMission.push(s),{success:!0,status:201})}isEarnedMission(t){return this.accumulatedMission.find(s=>s===t)?{success:!0,message:"",status:200}:{success:!1,message:"미션에 대한 적립 내역이 없습니다.",status:204}}getPoint(){return this.point}validateCheckPoint(t){return this.findMission(t).point}isCompletedMisson(t){return this.findUserMission(t)}setSavedData({performedMission:t,accumulatedMission:s,point:r}){this.performedMission=t,this.accumulatedMission=s,this.point=r}getSavedData(){return this.performedMission.length<=0&&this.accumulatedMission.length<=0?null:{performedMission:this.performedMission,accumulatedMission:this.accumulatedMission,point:this.point}}}const u=new h;var O=new TextEncoder;function me(e){return O.encode(e)}function ve(e,t){return new TextDecoder(t).decode(e)}function be(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function J(){if(typeof navigator<"u"&&navigator.product==="ReactNative")return!0;if(typeof process<"u"){const e=process.type;return e==="renderer"||e==="worker"?!1:!!(process.versions&&process.versions.node)}return!1}var Ee=/(%?)(%([sdijo]))/g;function Re(e,t){switch(t){case"s":return e;case"d":case"i":return Number(e);case"j":return JSON.stringify(e);case"o":{if(typeof e=="string")return e;const s=JSON.stringify(e);return s==="{}"||s==="[]"||/^\[object .+?\]$/.test(s)?e:s}}}function x(e,...t){if(t.length===0)return e;let s=0,r=e.replace(Ee,(i,n,o,a)=>{const c=t[s],d=Re(c,a);return n?i:(s++,d)});return s<t.length&&(r+=` ${t.slice(s).join(" ")}`),r=r.replace(/%{2,2}/g,"%"),r}var we=2;function qe(e){if(!e.stack)return;const t=e.stack.split(`
`);t.splice(1,we),e.stack=t.join(`
`)}var Se=class extends Error{constructor(e,...t){super(e),this.message=e,this.name="Invariant Violation",this.message=x(e,...t),qe(this)}},R=(e,t,...s)=>{if(!e)throw new Se(t,...s)};R.as=(e,t,s,...r)=>{if(!t){const i=r.length===0?s:x(s,...r);let n;try{n=Reflect.construct(e,[i])}catch{n=e(i)}throw n}};var Le={},xe=Object.defineProperty,Te=(e,t)=>{for(var s in t)xe(e,s,{get:t[s],enumerable:!0})},k={};Te(k,{blue:()=>Me,gray:()=>j,green:()=>_e,red:()=>Ie,yellow:()=>Pe});function Pe(e){return`\x1B[33m${e}\x1B[0m`}function Me(e){return`\x1B[34m${e}\x1B[0m`}function j(e){return`\x1B[90m${e}\x1B[0m`}function Ie(e){return`\x1B[31m${e}\x1B[0m`}function _e(e){return`\x1B[32m${e}\x1B[0m`}var A=J(),z=class{constructor(e){g(this,"prefix");this.name=e,this.prefix=`[${this.name}]`;const t=Y("DEBUG"),s=Y("LOG_LEVEL");t==="1"||t==="true"||typeof t<"u"&&this.name.startsWith(t)?(this.debug=T(s,"debug")?y:this.debug,this.info=T(s,"info")?y:this.info,this.success=T(s,"success")?y:this.success,this.warning=T(s,"warning")?y:this.warning,this.error=T(s,"error")?y:this.error):(this.info=y,this.success=y,this.warning=y,this.error=y,this.only=y)}extend(e){return new z(`${this.name}:${e}`)}debug(e,...t){this.logEntry({level:"debug",message:j(e),positionals:t,prefix:this.prefix,colors:{prefix:"gray"}})}info(e,...t){this.logEntry({level:"info",message:e,positionals:t,prefix:this.prefix,colors:{prefix:"blue"}});const s=new Oe;return(r,...i)=>{s.measure(),this.logEntry({level:"info",message:`${r} ${j(`${s.deltaTime}ms`)}`,positionals:i,prefix:this.prefix,colors:{prefix:"blue"}})}}success(e,...t){this.logEntry({level:"info",message:e,positionals:t,prefix:`✔ ${this.prefix}`,colors:{timestamp:"green",prefix:"green"}})}warning(e,...t){this.logEntry({level:"warning",message:e,positionals:t,prefix:`⚠ ${this.prefix}`,colors:{timestamp:"yellow",prefix:"yellow"}})}error(e,...t){this.logEntry({level:"error",message:e,positionals:t,prefix:`✖ ${this.prefix}`,colors:{timestamp:"red",prefix:"red"}})}only(e){e()}createEntry(e,t){return{timestamp:new Date,level:e,message:t}}logEntry(e){const{level:t,message:s,prefix:r,colors:i,positionals:n=[]}=e,o=this.createEntry(t,s),a=(i==null?void 0:i.timestamp)||"gray",c=(i==null?void 0:i.prefix)||"gray",d={timestamp:k[a],prefix:k[c]};this.getWriter(t)([d.timestamp(this.formatTimestamp(o.timestamp))].concat(r!=null?d.prefix(r):[]).concat(K(s)).join(" "),...n.map(K))}formatTimestamp(e){return`${e.toLocaleTimeString("en-GB")}:${e.getMilliseconds()}`}getWriter(e){switch(e){case"debug":case"success":case"info":return Ae;case"warning":return De;case"error":return He}}},Oe=class{constructor(){g(this,"startTime");g(this,"endTime");g(this,"deltaTime");this.startTime=performance.now()}measure(){this.endTime=performance.now();const e=this.endTime-this.startTime;this.deltaTime=e.toFixed(2)}},y=()=>{};function Ae(e,...t){if(A){process.stdout.write(x(e,...t)+`
`);return}console.log(e,...t)}function De(e,...t){if(A){process.stderr.write(x(e,...t)+`
`);return}console.warn(e,...t)}function He(e,...t){if(A){process.stderr.write(x(e,...t)+`
`);return}console.error(e,...t)}function Y(e){var t;return A?Le[e]:(t=globalThis[e])==null?void 0:t.toString()}function T(e,t){return e!==void 0&&e!==t}function K(e){return typeof e>"u"?"undefined":e===null?"null":typeof e=="string"?e:typeof e=="object"?JSON.stringify(e):e.toString()}var Ce=class extends Error{constructor(e,t,s){super(`Possible EventEmitter memory leak detected. ${s} ${t.toString()} listeners added. Use emitter.setMaxListeners() to increase limit`),this.emitter=e,this.type=t,this.count=s,this.name="MaxListenersExceededWarning"}},Q=class{static listenerCount(e,t){return e.listenerCount(t)}constructor(){this.events=new Map,this.maxListeners=Q.defaultMaxListeners,this.hasWarnedAboutPotentialMemoryLeak=!1}_emitInternalEvent(e,t,s){this.emit(e,t,s)}_getListeners(e){return Array.prototype.concat.apply([],this.events.get(e))||[]}_removeListener(e,t){const s=e.indexOf(t);return s>-1&&e.splice(s,1),[]}_wrapOnceListener(e,t){const s=(...r)=>(this.removeListener(e,s),t.apply(this,r));return Object.defineProperty(s,"name",{value:t.name}),s}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}eventNames(){return Array.from(this.events.keys())}emit(e,...t){const s=this._getListeners(e);return s.forEach(r=>{r.apply(this,t)}),s.length>0}addListener(e,t){this._emitInternalEvent("newListener",e,t);const s=this._getListeners(e).concat(t);if(this.events.set(e,s),this.maxListeners>0&&this.listenerCount(e)>this.maxListeners&&!this.hasWarnedAboutPotentialMemoryLeak){this.hasWarnedAboutPotentialMemoryLeak=!0;const r=new Ce(this,e,this.listenerCount(e));console.warn(r)}return this}on(e,t){return this.addListener(e,t)}once(e,t){return this.addListener(e,this._wrapOnceListener(e,t))}prependListener(e,t){const s=this._getListeners(e);if(s.length>0){const r=[t].concat(s);this.events.set(e,r)}else this.events.set(e,s.concat(t));return this}prependOnceListener(e,t){return this.prependListener(e,this._wrapOnceListener(e,t))}removeListener(e,t){const s=this._getListeners(e);return s.length>0&&(this._removeListener(s,t),this.events.set(e,s),this._emitInternalEvent("removeListener",e,t)),this}off(e,t){return this.removeListener(e,t)}removeAllListeners(e){return e?this.events.delete(e):this.events.clear(),this}listeners(e){return Array.from(this._getListeners(e))}listenerCount(e){return this._getListeners(e).length}rawListeners(e){return this.listeners(e)}},Z=Q;Z.defaultMaxListeners=10;var We=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},U=(e,t,s)=>(We(e,t,"read from private field"),s?s.call(e):t.get(e)),Be=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},ke="x-interceptors-internal-request-id";function ee(e){return globalThis[e]||void 0}function je(e,t){globalThis[e]=t}function Ue(e){delete globalThis[e]}var te=class{constructor(e){this.symbol=e,this.readyState="INACTIVE",this.emitter=new Z,this.subscriptions=[],this.logger=new z(e.description),this.emitter.setMaxListeners(0),this.logger.info("constructing the interceptor...")}checkEnvironment(){return!0}apply(){const e=this.logger.extend("apply");if(e.info("applying the interceptor..."),this.readyState==="APPLIED"){e.info("intercepted already applied!");return}if(!this.checkEnvironment()){e.info("the interceptor cannot be applied in this environment!");return}this.readyState="APPLYING";const s=this.getInstance();if(s){e.info("found a running instance, reusing..."),this.on=(r,i)=>(e.info('proxying the "%s" listener',r),s.emitter.addListener(r,i),this.subscriptions.push(()=>{s.emitter.removeListener(r,i),e.info('removed proxied "%s" listener!',r)}),this),this.readyState="APPLIED";return}e.info("no running instance found, setting up a new instance..."),this.setup(),this.setInstance(),this.readyState="APPLIED"}setup(){}on(e,t){const s=this.logger.extend("on");return this.readyState==="DISPOSING"||this.readyState==="DISPOSED"?(s.info("cannot listen to events, already disposed!"),this):(s.info('adding "%s" event listener:',e,t),this.emitter.on(e,t),this)}once(e,t){return this.emitter.once(e,t),this}off(e,t){return this.emitter.off(e,t),this}removeAllListeners(e){return this.emitter.removeAllListeners(e),this}dispose(){const e=this.logger.extend("dispose");if(this.readyState==="DISPOSED"){e.info("cannot dispose, already disposed!");return}if(e.info("disposing the interceptor..."),this.readyState="DISPOSING",!this.getInstance()){e.info("no interceptors running, skipping dispose...");return}if(this.clearInstance(),e.info("global symbol deleted:",ee(this.symbol)),this.subscriptions.length>0){e.info("disposing of %d subscriptions...",this.subscriptions.length);for(const t of this.subscriptions)t();this.subscriptions=[],e.info("disposed of all subscriptions!",this.subscriptions.length)}this.emitter.removeAllListeners(),e.info("destroyed the listener!"),this.readyState="DISPOSED"}getInstance(){var e;const t=ee(this.symbol);return this.logger.info("retrieved global instance:",(e=t==null?void 0:t.constructor)==null?void 0:e.name),t}setInstance(){je(this.symbol,this),this.logger.info("set global instance!",this.symbol.description)}clearInstance(){Ue(this.symbol),this.logger.info("cleared global instance!",this.symbol.description)}};function Ne(){return Math.random().toString(16).slice(2)}function Ge(){const e=(t,s)=>{e.state="pending",e.resolve=r=>{if(e.state!=="pending")return;e.result=r;const i=n=>(e.state="fulfilled",n);return t(r instanceof Promise?r:Promise.resolve(r).then(i))},e.reject=r=>{if(e.state==="pending")return queueMicrotask(()=>{e.state="rejected"}),s(e.rejectionReason=r)}};return e}var se=(pe=class extends Promise{constructor(t=null){const s=Ge();super((r,i)=>{s(r,i),t==null||t(s.resolve,s.reject)});V(this,L);V(this,E);g(this,"resolve");g(this,"reject");ye(this,E,s),this.resolve=_(this,E).resolve,this.reject=_(this,E).reject}get state(){return _(this,E).state}get rejectionReason(){return _(this,E).rejectionReason}then(t,s){return W(this,L,B).call(this,super.then(t,s))}catch(t){return W(this,L,B).call(this,super.catch(t))}finally(t){return W(this,L,B).call(this,super.finally(t))}},E=new WeakMap,L=new WeakSet,B=function(t){return Object.defineProperties(t,{resolve:{configurable:!0,value:this.resolve},reject:{configurable:!0,value:this.reject}})},pe),N=Symbol("isPatchedModule"),P=class extends Error{constructor(e){super(e),this.name="InterceptorError",Object.setPrototypeOf(this,P.prototype)}},M,D,v=class{constructor(e,t){this.request=e,this.source=t,Be(this,M),this.readyState=v.PENDING,this.handled=new se}async passthrough(){R.as(P,this.readyState===v.PENDING,'Failed to passthrough the "%s %s" request: the request has already been handled',this.request.method,this.request.url),this.readyState=v.PASSTHROUGH,await this.source.passthrough(),U(this,M,D).resolve()}respondWith(e){R.as(P,this.readyState===v.PENDING,'Failed to respond to the "%s %s" request with "%d %s": the request has already been handled (%d)',this.request.method,this.request.url,e.status,e.statusText||"OK",this.readyState),this.readyState=v.RESPONSE,U(this,M,D).resolve(),this.source.respondWith(e)}errorWith(e){R.as(P,this.readyState===v.PENDING,'Failed to error the "%s %s" request with "%s": the request has already been handled (%d)',this.request.method,this.request.url,e==null?void 0:e.toString(),this.readyState),this.readyState=v.ERROR,this.source.errorWith(e),U(this,M,D).resolve()}},b=v;M=new WeakSet,D=function(){return this.handled},b.PENDING=0,b.PASSTHROUGH=1,b.RESPONSE=2,b.ERROR=3;function Xe(e){try{return new URL(e),!0}catch{return!1}}function re(e,t){const r=Object.getOwnPropertySymbols(t).find(i=>i.description===e);if(r)return Reflect.get(t,r)}var w=class extends Response{static isConfigurableStatusCode(e){return e>=200&&e<=599}static isRedirectResponse(e){return w.STATUS_CODES_WITH_REDIRECT.includes(e)}static isResponseWithBody(e){return!w.STATUS_CODES_WITHOUT_BODY.includes(e)}static setUrl(e,t){if(!e||e==="about:"||!Xe(e))return;const s=re("state",t);s?s.urlList.push(new URL(e)):Object.defineProperty(t,"url",{value:e,enumerable:!0,configurable:!0,writable:!1})}static parseRawHeaders(e){const t=new Headers;for(let s=0;s<e.length;s+=2)t.append(e[s],e[s+1]);return t}constructor(e,t={}){var s;const r=(s=t.status)!=null?s:200,i=w.isConfigurableStatusCode(r)?r:200,n=w.isResponseWithBody(r)?e:null;if(super(n,{status:i,statusText:t.statusText,headers:t.headers}),r!==i){const o=re("state",this);o?o.status=r:Object.defineProperty(this,"status",{value:r,enumerable:!0,configurable:!0,writable:!1})}w.setUrl(t.url,this)}},H=w;H.STATUS_CODES_WITHOUT_BODY=[101,103,204,205,304],H.STATUS_CODES_WITH_REDIRECT=[301,302,303,307,308];var $e=Symbol("kRawRequest");function Fe(e,t){Reflect.set(e,$e,t)}var G=class extends te{constructor(e){G.symbol=Symbol(e.name),super(G.symbol),this.interceptors=e.interceptors}setup(){const e=this.logger.extend("setup");e.info("applying all %d interceptors...",this.interceptors.length);for(const t of this.interceptors)e.info('applying "%s" interceptor...',t.constructor.name),t.apply(),e.info("adding interceptor dispose subscription"),this.subscriptions.push(()=>t.dispose())}on(e,t){for(const s of this.interceptors)s.on(e,t);return this}once(e,t){for(const s of this.interceptors)s.once(e,t);return this}off(e,t){for(const s of this.interceptors)s.off(e,t);return this}removeAllListeners(e){for(const t of this.interceptors)t.removeAllListeners(e);return this}};async function ne(e,t,...s){const r=e.listeners(t);if(r.length!==0)for(const i of r)await i.apply(e,s)}function Ve(e){const t=Object.getOwnPropertyDescriptor(globalThis,e);return typeof t>"u"||typeof t.get=="function"&&typeof t.get()>"u"||typeof t.get>"u"&&t.value==null?!1:typeof t.set>"u"&&!t.configurable?(console.error(`[MSW] Failed to apply interceptor: the global \`${e}\` property is non-configurable. This is likely an issue with your environment. If you are using a framework, please open an issue about this in their repository.`),!1):!0}var Je=async e=>{try{return{error:null,data:await e().catch(s=>{throw s})}}catch(t){return{error:t,data:null}}};function ie(e,t=!1){return t?Object.prototype.toString.call(e).startsWith("[object "):Object.prototype.toString.call(e)==="[object Object]"}function C(e,t){try{return e[t],!0}catch{return!1}}function ze(e){return new Response(JSON.stringify(e instanceof Error?{name:e.name,message:e.message,stack:e.stack}:e),{status:500,statusText:"Unhandled Exception",headers:{"Content-Type":"application/json"}})}function oe(e){return e!=null&&e instanceof Response&&C(e,"type")&&e.type==="error"}function Ye(e){return ie(e,!0)&&C(e,"status")&&C(e,"statusText")&&C(e,"bodyUsed")}function Ke(e){return e==null||!(e instanceof Error)?!1:"code"in e&&"errno"in e}async function Qe(e){const t=async n=>n instanceof Error?(await e.controller.errorWith(n),!0):oe(n)?(await e.controller.respondWith(n),!0):Ye(n)?(await e.controller.respondWith(n),!0):ie(n)?(await e.controller.errorWith(n),!0):!1,s=async n=>{if(n instanceof P)throw i.error;return Ke(n)?(await e.controller.errorWith(n),!0):n instanceof Response?await t(n):!1},r=new se;if(e.request.signal){if(e.request.signal.aborted){await e.controller.errorWith(e.request.signal.reason);return}e.request.signal.addEventListener("abort",()=>{r.reject(e.request.signal.reason)},{once:!0})}const i=await Je(async()=>{const n=ne(e.emitter,"request",{requestId:e.requestId,request:e.request,controller:e.controller});await Promise.race([r,n,e.controller.handled])});if(r.state==="rejected"){await e.controller.errorWith(r.rejectionReason);return}if(i.error){if(await s(i.error))return;if(e.emitter.listenerCount("unhandledException")>0){const n=new b(e.request,{passthrough(){},async respondWith(o){await t(o)},async errorWith(o){await e.controller.errorWith(o)}});if(await ne(e.emitter,"unhandledException",{error:i.error,request:e.request,requestId:e.requestId,controller:n}),n.readyState!==b.PENDING)return}await e.controller.respondWith(ze(i.error));return}return e.controller.readyState===b.PENDING?await e.controller.passthrough():e.controller.handled}function Ze(e,t){const s=new Uint8Array(e.byteLength+t.byteLength);return s.set(e,0),s.set(t,e.byteLength),s}var ae=class{constructor(e,t){this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.type="",this.srcElement=null,this.currentTarget=null,this.eventPhase=0,this.isTrusted=!0,this.composed=!1,this.cancelable=!0,this.defaultPrevented=!1,this.bubbles=!0,this.lengthComputable=!0,this.loaded=0,this.total=0,this.cancelBubble=!1,this.returnValue=!0,this.type=e,this.target=(t==null?void 0:t.target)||null,this.currentTarget=(t==null?void 0:t.currentTarget)||null,this.timeStamp=Date.now()}composedPath(){return[]}initEvent(e,t,s){this.type=e,this.bubbles=!!t,this.cancelable=!!s}preventDefault(){this.defaultPrevented=!0}stopPropagation(){}stopImmediatePropagation(){}},et=class extends ae{constructor(e,t){super(e),this.lengthComputable=(t==null?void 0:t.lengthComputable)||!1,this.composed=(t==null?void 0:t.composed)||!1,this.loaded=(t==null?void 0:t.loaded)||0,this.total=(t==null?void 0:t.total)||0}},tt=typeof ProgressEvent<"u";function st(e,t,s){const r=["error","progress","loadstart","loadend","load","timeout","abort"],i=tt?ProgressEvent:et;return r.includes(t)?new i(t,{lengthComputable:!0,loaded:(s==null?void 0:s.loaded)||0,total:(s==null?void 0:s.total)||0}):new ae(t,{target:e,currentTarget:e})}function ue(e,t){if(!(t in e))return null;if(Object.prototype.hasOwnProperty.call(e,t))return e;const r=Reflect.getPrototypeOf(e);return r?ue(r,t):null}function X(e,t){return new Proxy(e,rt(t))}function rt(e){const{constructorCall:t,methodCall:s,getProperty:r,setProperty:i}=e,n={};return typeof t<"u"&&(n.construct=function(o,a,c){const d=Reflect.construct.bind(null,o,a,c);return t.call(c,a,d)}),n.set=function(o,a,c){const d=()=>{const f=ue(o,a)||o,m=Reflect.getOwnPropertyDescriptor(f,a);return typeof(m==null?void 0:m.set)<"u"?(m.set.apply(o,[c]),!0):Reflect.defineProperty(f,a,{writable:!0,enumerable:!0,configurable:!0,value:c})};return typeof i<"u"?i.call(o,[a,c],d):d()},n.get=function(o,a,c){const d=()=>o[a],f=typeof r<"u"?r.call(o,[a,c],d):d();return typeof f=="function"?(...m)=>{const p=f.bind(o,...m);return typeof s<"u"?s.call(o,[a,m],p):p()}:f},n}function nt(e){return["application/xhtml+xml","application/xml","image/svg+xml","text/html","text/xml"].some(s=>e.startsWith(s))}function it(e){try{return JSON.parse(e)}catch{return null}}function ot(e,t){const s=H.isResponseWithBody(e.status)?t:null;return new H(s,{url:e.responseURL,status:e.status,statusText:e.statusText,headers:at(e.getAllResponseHeaders())})}function at(e){const t=new Headers,s=e.split(/[\r\n]+/);for(const r of s){if(r.trim()==="")continue;const[i,...n]=r.split(": "),o=n.join(": ");t.append(i,o)}return t}async function le(e){const t=e.headers.get("content-length");return t!=null&&t!==""?Number(t):(await e.arrayBuffer()).byteLength}var I=Symbol("kIsRequestHandled"),ut=J(),$=Symbol("kFetchRequest"),lt=class{constructor(e,t){this.initialRequest=e,this.logger=t,this.method="GET",this.url=null,this[I]=!1,this.events=new Map,this.uploadEvents=new Map,this.requestId=Ne(),this.requestHeaders=new Headers,this.responseBuffer=new Uint8Array,this.request=X(e,{setProperty:([s,r],i)=>{switch(s){case"ontimeout":{const n=s.slice(2);return this.request.addEventListener(n,r),i()}default:return i()}},methodCall:([s,r],i)=>{switch(s){case"open":{const[n,o]=r;return typeof o>"u"?(this.method="GET",this.url=ce(n)):(this.method=n,this.url=ce(o)),this.logger=this.logger.extend(`${this.method} ${this.url.href}`),this.logger.info("open",this.method,this.url.href),i()}case"addEventListener":{const[n,o]=r;return this.registerEvent(n,o),this.logger.info("addEventListener",n,o),i()}case"setRequestHeader":{const[n,o]=r;return this.requestHeaders.set(n,o),this.logger.info("setRequestHeader",n,o),i()}case"send":{const[n]=r;this.request.addEventListener("load",()=>{if(typeof this.onResponse<"u"){const c=ot(this.request,this.request.response);this.onResponse.call(this,{response:c,isMockedResponse:this[I],request:a,requestId:this.requestId})}});const o=typeof n=="string"?me(n):n,a=this.toFetchApiRequest(o);this[$]=a.clone(),queueMicrotask(()=>{var c;(((c=this.onRequest)==null?void 0:c.call(this,{request:a,requestId:this.requestId}))||Promise.resolve()).finally(()=>{if(!this[I])return this.logger.info("request callback settled but request has not been handled (readystate %d), performing as-is...",this.request.readyState),ut&&this.request.setRequestHeader(ke,this.requestId),i()})});break}default:return i()}}}),q(this.request,"upload",X(this.request.upload,{setProperty:([s,r],i)=>{switch(s){case"onloadstart":case"onprogress":case"onaboart":case"onerror":case"onload":case"ontimeout":case"onloadend":{const n=s.slice(2);this.registerUploadEvent(n,r)}}return i()},methodCall:([s,r],i)=>{switch(s){case"addEventListener":{const[n,o]=r;return this.registerUploadEvent(n,o),this.logger.info("upload.addEventListener",n,o),i()}}}}))}registerEvent(e,t){const r=(this.events.get(e)||[]).concat(t);this.events.set(e,r),this.logger.info('registered event "%s"',e,t)}registerUploadEvent(e,t){const r=(this.uploadEvents.get(e)||[]).concat(t);this.uploadEvents.set(e,r),this.logger.info('registered upload event "%s"',e,t)}async respondWith(e){if(this[I]=!0,this[$]){const r=await le(this[$]);this.trigger("loadstart",this.request.upload,{loaded:0,total:r}),this.trigger("progress",this.request.upload,{loaded:r,total:r}),this.trigger("load",this.request.upload,{loaded:r,total:r}),this.trigger("loadend",this.request.upload,{loaded:r,total:r})}this.logger.info("responding with a mocked response: %d %s",e.status,e.statusText),q(this.request,"status",e.status),q(this.request,"statusText",e.statusText),q(this.request,"responseURL",this.url.href),this.request.getResponseHeader=new Proxy(this.request.getResponseHeader,{apply:(r,i,n)=>{if(this.logger.info("getResponseHeader",n[0]),this.request.readyState<this.request.HEADERS_RECEIVED)return this.logger.info("headers not received yet, returning null"),null;const o=e.headers.get(n[0]);return this.logger.info('resolved response header "%s" to',n[0],o),o}}),this.request.getAllResponseHeaders=new Proxy(this.request.getAllResponseHeaders,{apply:()=>{if(this.logger.info("getAllResponseHeaders"),this.request.readyState<this.request.HEADERS_RECEIVED)return this.logger.info("headers not received yet, returning empty string"),"";const i=Array.from(e.headers.entries()).map(([n,o])=>`${n}: ${o}`).join(`\r
`);return this.logger.info("resolved all response headers to",i),i}}),Object.defineProperties(this.request,{response:{enumerable:!0,configurable:!1,get:()=>this.response},responseText:{enumerable:!0,configurable:!1,get:()=>this.responseText},responseXML:{enumerable:!0,configurable:!1,get:()=>this.responseXML}});const t=await le(e.clone());this.logger.info("calculated response body length",t),this.trigger("loadstart",this.request,{loaded:0,total:t}),this.setReadyState(this.request.HEADERS_RECEIVED),this.setReadyState(this.request.LOADING);const s=()=>{this.logger.info("finalizing the mocked response..."),this.setReadyState(this.request.DONE),this.trigger("load",this.request,{loaded:this.responseBuffer.byteLength,total:t}),this.trigger("loadend",this.request,{loaded:this.responseBuffer.byteLength,total:t})};if(e.body){this.logger.info("mocked response has body, streaming...");const r=e.body.getReader(),i=async()=>{const{value:n,done:o}=await r.read();if(o){this.logger.info("response body stream done!"),s();return}n&&(this.logger.info("read response body chunk:",n),this.responseBuffer=Ze(this.responseBuffer,n),this.trigger("progress",this.request,{loaded:this.responseBuffer.byteLength,total:t})),i()};i()}else s()}responseBufferToText(){return ve(this.responseBuffer)}get response(){if(this.logger.info("getResponse (responseType: %s)",this.request.responseType),this.request.readyState!==this.request.DONE)return null;switch(this.request.responseType){case"json":{const e=it(this.responseBufferToText());return this.logger.info("resolved response JSON",e),e}case"arraybuffer":{const e=be(this.responseBuffer);return this.logger.info("resolved response ArrayBuffer",e),e}case"blob":{const e=this.request.getResponseHeader("Content-Type")||"text/plain",t=new Blob([this.responseBufferToText()],{type:e});return this.logger.info("resolved response Blob (mime type: %s)",t,e),t}default:{const e=this.responseBufferToText();return this.logger.info('resolving "%s" response type as text',this.request.responseType,e),e}}}get responseText(){if(R(this.request.responseType===""||this.request.responseType==="text","InvalidStateError: The object is in invalid state."),this.request.readyState!==this.request.LOADING&&this.request.readyState!==this.request.DONE)return"";const e=this.responseBufferToText();return this.logger.info('getResponseText: "%s"',e),e}get responseXML(){if(R(this.request.responseType===""||this.request.responseType==="document","InvalidStateError: The object is in invalid state."),this.request.readyState!==this.request.DONE)return null;const e=this.request.getResponseHeader("Content-Type")||"";return typeof DOMParser>"u"?(console.warn("Cannot retrieve XMLHttpRequest response body as XML: DOMParser is not defined. You are likely using an environment that is not browser or does not polyfill browser globals correctly."),null):nt(e)?new DOMParser().parseFromString(this.responseBufferToText(),e):null}errorWith(e){this[I]=!0,this.logger.info("responding with an error"),this.setReadyState(this.request.DONE),this.trigger("error",this.request),this.trigger("loadend",this.request)}setReadyState(e){if(this.logger.info("setReadyState: %d -> %d",this.request.readyState,e),this.request.readyState===e){this.logger.info("ready state identical, skipping transition...");return}q(this.request,"readyState",e),this.logger.info("set readyState to: %d",e),e!==this.request.UNSENT&&(this.logger.info('triggering "readystatechange" event...'),this.trigger("readystatechange",this.request))}trigger(e,t,s){const r=t[`on${e}`],i=st(t,e,s);this.logger.info('trigger "%s"',e,s||""),typeof r=="function"&&(this.logger.info('found a direct "%s" callback, calling...',e),r.call(t,i));const n=t instanceof XMLHttpRequestUpload?this.uploadEvents:this.events;for(const[o,a]of n)o===e&&(this.logger.info('found %d listener(s) for "%s" event, calling...',a.length,e),a.forEach(c=>c.call(t,i)))}toFetchApiRequest(e){this.logger.info("converting request to a Fetch API Request...");const t=e instanceof Document?e.documentElement.innerText:e,s=new Request(this.url.href,{method:this.method,headers:this.requestHeaders,credentials:this.request.withCredentials?"include":"same-origin",body:["GET","HEAD"].includes(this.method.toUpperCase())?null:t}),r=X(s.headers,{methodCall:([i,n],o)=>{switch(i){case"append":case"set":{const[a,c]=n;this.request.setRequestHeader(a,c);break}case"delete":{const[a]=n;console.warn(`XMLHttpRequest: Cannot remove a "${a}" header from the Fetch API representation of the "${s.method} ${s.url}" request. XMLHttpRequest headers cannot be removed.`);break}}return o()}});return q(s,"headers",r),Fe(s,this.request),this.logger.info("converted request to a Fetch API Request!",s),s}};function ce(e){return typeof location>"u"?new URL(e):new URL(e.toString(),location.href)}function q(e,t,s){Reflect.defineProperty(e,t,{writable:!0,enumerable:!0,value:s})}function ct({emitter:e,logger:t}){return new Proxy(globalThis.XMLHttpRequest,{construct(r,i,n){t.info("constructed new XMLHttpRequest");const o=Reflect.construct(r,i,n),a=Object.getOwnPropertyDescriptors(r.prototype);for(const d in a)Reflect.defineProperty(o,d,a[d]);const c=new lt(o,t);return c.onRequest=async function({request:d,requestId:f}){const m=new b(d,{passthrough:()=>{this.logger.info("no mocked response received, performing request as-is...")},respondWith:async p=>{if(oe(p)){this.errorWith(new TypeError("Network error"));return}await this.respondWith(p)},errorWith:p=>{this.logger.info("request errored!",{error:p}),p instanceof Error&&this.errorWith(p)}});this.logger.info("awaiting mocked response..."),this.logger.info('emitting the "request" event for %s listener(s)...',e.listenerCount("request")),await Qe({request:d,requestId:f,controller:m,emitter:e})},c.onResponse=async function({response:d,isMockedResponse:f,request:m,requestId:p}){this.logger.info('emitting the "response" event for %s listener(s)...',e.listenerCount("response")),e.emit("response",{response:d,isMockedResponse:f,request:m,requestId:p})},c.request}})}var he=class extends te{constructor(){super(he.interceptorSymbol)}checkEnvironment(){return Ve("XMLHttpRequest")}setup(){const e=this.logger.extend("setup");e.info('patching "XMLHttpRequest" module...');const t=globalThis.XMLHttpRequest;R(!t[N],'Failed to patch the "XMLHttpRequest" module: already patched.'),globalThis.XMLHttpRequest=ct({emitter:this.emitter,logger:this.logger}),e.info('native "XMLHttpRequest" module patched!',globalThis.XMLHttpRequest.name),Object.defineProperty(globalThis.XMLHttpRequest,N,{enumerable:!0,configurable:!0,value:!0}),this.subscriptions.push(()=>{Object.defineProperty(globalThis.XMLHttpRequest,N,{value:void 0}),globalThis.XMLHttpRequest=t,e.info('native "XMLHttpRequest" module restored!',globalThis.XMLHttpRequest.name)})}},de=he;de.interceptorSymbol=Symbol("xhr");const ht="MSW_ACTIVATE",dt="SAVE_DATA",ft="MSW_LOAD_REWARD_DATA",fe=new G({name:"my-interceptor",interceptors:[new de]});window.addEventListener("message",e=>{var t;((t=e.data)==null?void 0:t.type)===ft&&u.setSavedData(e.data.payload)});const S=(e,t)=>(window.postMessage({type:dt,payload:JSON.stringify(u.getSavedData())}),new Response(JSON.stringify(e),{...t,headers:{"Content-Type":"application/json"}}));window.addEventListener(ht,()=>{fe.apply(),fe.on("request",async({request:e,controller:t})=>{if(/^https?:\/\/example.reward.com/.test(e.url)){if(e.method.toLowerCase()==="get"&&/^https?:\/\/example.reward.com\/api\/missions/.test(e.url))return t.respondWith(S(u.getMission(),{status:200}));if(e.method.toLowerCase()==="get"){if(/^https?:\/\/example.reward.com\/api\/user\/missions/.test(e.url))return t.respondWith(S(u.getUserMission(),{status:200}));if(/^https?:\/\/example.reward.com\/api\/user\/earn/.test(e.url)){const s=new URL(e.url).pathname.split("/").slice(-1)[0],r=u.isEarnedMission(Number(s));return t.respondWith(S(r,{status:201}))}if(/^https?:\/\/example.reward.com\/api\/user\/point/.test(e.url)){const s=u.getPoint();return t.respondWith(S(s,{status:200}))}}if(e.method.toLowerCase()==="post"){if(/^https?:\/\/example.reward.com\/api\/user\/point\/save/.test(e.url)){const{missionId:s,point:r}=await e.json(),i=u.savePoint({missionId:s,point:r});return t.respondWith(S(i,{status:201}))}if(/^https?:\/\/example.reward.com\/api\/user\/mission\/join/.test(e.url)){const s=new URL(e.url).pathname.split("/").slice(-1)[0],r=u.joinMission(Number(s));return t.respondWith(S(r,{status:201}))}}}})})})();
